webpackJsonp([4],{FLzq:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("4YfN"),n=a.n(i),o=a("9rMa"),s=a("2OfA"),r=void 0,c={data:function(){return{pickerValue:"2018-01-01 12:00:00",openpickType:"start",start_time:"",end_time:"",isquery:!1,trackData:[]}},computed:n()({},Object(o.b)(["userInfo"])),created:function(){var t=navigator.userAgent.toLowerCase();if(/iphone|ipad|ipod/.test(t))try{window.toggleNav("")}catch(t){t instanceof TypeError&&console.log("无该函数方法")}else if(/android/.test(t))try{window.clientJS.toggleNav("")}catch(t){t instanceof TypeError&&console.log("无该函数方法")}},mounted:function(){this.map=new AMap.Map("container",{resizeEnable:!0,zoom:14})},methods:{getdata:function(){var t=this;this.$http.get(this.HOST+"/get/historyLocation",{params:{userToken:this.userInfo.userToken,imei:this.userInfo.uid,start_time:this.start_time,end_time:this.end_time}}).then(function(e){"000000"==e.data.code?0!=e.data.data.length?(t.trackData=e.data.data,t.track()):t.toast("该时间阶段轨迹数据暂无"):t.toast(e.data.msg)}).catch(function(e){t.toast("查询失败！")})},openPicker:function(t){this.$refs.picker.open(),this.openpickType=t},handleConfirm:function(t){var e=Date.parse(new Date(t))/1e3;"start"==this.openpickType?this.start_time=e:this.end_time=e},queryTrack:function(){""==this.start_time?this.toast("请选择开始时间"):""==this.end_time?this.toast("请选择结束时间"):this.getdata()},track:function(){var t=this;this.isquery=!0,this.map=new AMap.Map("container",{resizeEnable:!0,zoom:18,center:this.trackData[0]}),r=new AMap.Marker({map:this.map,position:this.trackData[0],icon:"https://webapi.amap.com/theme/v1.3/markers/n/loc.png",offset:new AMap.Pixel(-20,-10),autoRotation:!0}),s.lazyAMapApiLoaderInstance.load().then(function(){t.trackData.forEach(function(e,a,i){new AMap.Marker({map:t.map,content:'<div class="crile" style="width: 5px;height: 5px;background-color: #1296db;border-radius: 50%"></div>',position:new AMap.LngLat(e[0],e[1]),offset:new AMap.Pixel(-3,-3)}).setMap(t.map)});new AMap.Polyline({map:t.map,path:t.trackData,strokeColor:"#f7b538",strokeWeight:3});var e=new AMap.Polyline({map:t.map,strokeColor:"#1296db",strokeWeight:3});r.on("moving",function(t){e.setPath(t.passedPath)}),t.map.setFitView(),r.moveAlong(t.trackData,100)})},goback:function(){this.$router.go(-1)}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"warper"},[a("mt-header",{attrs:{title:"轨迹回放"}},[a("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:t.goback},slot:"left"},[t._v("返回")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isquery,expression:"isquery"}],attrs:{id:"container"}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isquery,expression:"!isquery"}],staticClass:"cnt"},[t._v("请选择需要查询的时间段查询轨迹")]),t._v(" "),a("div",{staticClass:"footer-time"},[a("div",{staticClass:"time"},[a("p",{on:{click:function(e){t.openPicker("start")}}},[t._v(t._s(""==t.start_time?"请选择开始时间":t.getLocalTime(t.start_time)))]),t._v(" "),a("p",[t._v(" - ")]),t._v(" "),a("p",{on:{click:function(e){t.openPicker("end")}}},[t._v(t._s(""==t.end_time?"请选择结束时间":t.getLocalTime(t.end_time)))])]),t._v(" "),a("div",{staticClass:"btn-ok",on:{click:t.queryTrack}},[t._v("确定")])]),t._v(" "),a("mt-datetime-picker",{ref:"picker",attrs:{type:"datetime"},on:{confirm:t.handleConfirm},model:{value:t.pickerValue,callback:function(e){t.pickerValue=e},expression:"pickerValue"}})],1)},staticRenderFns:[]};var d=a("Z0/y")(c,p,!1,function(t){a("cc7Z")},"data-v-8428c486",null);e.default=d.exports},cc7Z:function(t,e){}});
//# sourceMappingURL=4.49b235a06513ff64401f.js.map
{"version":3,"sources":["webpack:///src/views/track/track.vue","webpack:///./src/views/track/track.vue?2128","webpack:///./src/views/track/track.vue"],"names":["marker","track_track","computed","extends_default","Object","vuex_esm","userToken","uid","start_time","end_time","then","res","data","track","msg","open","type","timestamp","getdata","_this3","this","map","content","trackData","passedPath","setFitView","views_track_track","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","title","slot","icon","on","click","goback","_v","directives","name","rawName","value","expression","id","isquery","$event","openPicker","_s","getLocalTime","queryTrack","ref","confirm","handleConfirm","model","callback","$$v","pickerValue","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"sJA0BAA,OAAA,EACAC,sCAIA,mCACA,mBACA,YACA,YACA,iBAIAC,SAAAC,OAAAC,OAAAC,EAAA,EAAAD,EAEA,4HAMA,iDAGA,kEAKA,iDAGA,gFAOA,OAEA,8HAMAE,6BACAC,oBACAC,yBAEAC,YANAC,KAAA,SAAAC,mEAUAC,OACAC,iBAEA,8BAGAC,iCAGA,qDAIAC,yBACAC,2DAGA,+CAEAC,gBAEAA,wDAKA,wCAEA,gBAEAC,4BAGA,IAAAC,EAAAC,mBAEA,mDAEA,OACA,yBAEA,iCAEAC,4BACA,QACA,kFACA,kBAEA,kHAKAA,IACAC,QAAA,wIACA,4EAMAD,WACAE,gFAQAF,iFAQAG,oBAEAC,qCACA,2CAKA,MCnKAC,GADiBC,OAFjB,WAA0B,IAAAC,EAAAR,KAAaS,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,WAAqBF,EAAA,aAAkBG,OAAOC,MAAA,UAAgBJ,EAAA,aAAkBG,OAAOE,KAAA,OAAAC,KAAA,QAA4BC,IAAKC,MAAAX,EAAAY,QAAmBJ,KAAA,SAAaR,EAAAa,GAAA,YAAAb,EAAAa,GAAA,KAAAV,EAAA,OAA2CW,aAAaC,KAAA,OAAAC,QAAA,SAAAC,MAAAjB,EAAA,QAAAkB,WAAA,YAAsEZ,OAASa,GAAA,eAAkBnB,EAAAa,GAAA,KAAAV,EAAA,OAAwBW,aAAaC,KAAA,OAAAC,QAAA,SAAAC,OAAAjB,EAAAoB,QAAAF,WAAA,aAAwEb,YAAA,QAAoBL,EAAAa,GAAA,qBAAAb,EAAAa,GAAA,KAAAV,EAAA,OAAoDE,YAAA,gBAA0BF,EAAA,OAAYE,YAAA,SAAmBF,EAAA,KAAUO,IAAIC,MAAA,SAAAU,GAAyBrB,EAAAsB,WAAA,aAA0BtB,EAAAa,GAAAb,EAAAuB,GAAA,IAAAvB,EAAApB,WAAA,UAAAoB,EAAAwB,aAAAxB,EAAApB,gBAAAoB,EAAAa,GAAA,KAAAV,EAAA,KAAAH,EAAAa,GAAA,SAAAb,EAAAa,GAAA,KAAAV,EAAA,KAA0IO,IAAIC,MAAA,SAAAU,GAAyBrB,EAAAsB,WAAA,WAAwBtB,EAAAa,GAAAb,EAAAuB,GAAA,IAAAvB,EAAAnB,SAAA,UAAAmB,EAAAwB,aAAAxB,EAAAnB,gBAAAmB,EAAAa,GAAA,KAAAV,EAAA,OAAsGE,YAAA,SAAAK,IAAyBC,MAAAX,EAAAyB,cAAwBzB,EAAAa,GAAA,UAAAb,EAAAa,GAAA,KAAAV,EAAA,sBAAwDuB,IAAA,SAAApB,OAAoBlB,KAAA,YAAkBsB,IAAKiB,QAAA3B,EAAA4B,eAA4BC,OAAQZ,MAAAjB,EAAA,YAAA8B,SAAA,SAAAC,GAAiD/B,EAAAgC,YAAAD,GAAoBb,WAAA,kBAA2B,IAEtvCe,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACA/D,EACAyB,GATA,EAVA,SAAAuC,GACAF,EAAA,SAaA,kBAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"static/js/4.49b235a06513ff64401f.js","sourcesContent":["<template>\n  <div class=\"warper\">\n    <mt-header title=\"轨迹回放\">\n      <mt-button icon=\"back\" @click=\"goback\" slot=\"left\">返回</mt-button>\n    </mt-header>\n    <div id=\"container\" v-show=\"isquery\"></div>\n    <div class=\"cnt\" v-show=\"!isquery\">请选择需要查询的时间段查询轨迹</div>\n    <div class=\"footer-time\">\n      <div class=\"time\">\n        <p @click=\"openPicker('start')\">{{start_time==''?'请选择开始时间':getLocalTime(start_time)}}</p>\n        <p>&nbsp;-&nbsp;</p>\n        <p @click=\"openPicker('end')\">{{end_time==''?'请选择结束时间':getLocalTime(end_time)}}</p>\n      </div>\n      <div class=\"btn-ok\" @click=\"queryTrack\">确定</div>\n    </div>\n    <mt-datetime-picker\n      ref=\"picker\"\n      type=\"datetime\"\n      v-model=\"pickerValue\" @confirm=\"handleConfirm\">\n    </mt-datetime-picker>\n  </div>\n</template>\n<script>\n  import {mapGetters} from \"vuex\";\n  import {lazyAMapApiLoaderInstance} from 'vue-amap';\n\n  let marker;\n  export default {\n    data() {\n      return {\n        pickerValue: '2018-01-01 12:00:00',\n        openpickType: 'start',\n        start_time: '',\n        end_time: '',\n        isquery: false,\n        trackData: [],\n      };\n    },\n    computed: {\n      ...mapGetters([\"userInfo\"])\n    },\n    created(){\n      //调用app方法\n      var ua = navigator.userAgent.toLowerCase();//获取当前设备信息\n      if (/iphone|ipad|ipod/.test(ua)) {//如果是ios\n        try{\n          window.toggleNav('');\n        }catch (e){\n          if (e instanceof TypeError){\n            console.log('无该函数方法')\n          }\n        }\n      } else if (/android/.test(ua)) {//安卓\n        try{\n          window.clientJS.toggleNav('');\n        }catch (e){\n          if (e instanceof TypeError){\n            console.log('无该函数方法')\n          }\n        }\n      }\n    },\n    mounted() {\n      this.map = new AMap.Map(\"container\", {\n        resizeEnable: true,\n        zoom: 14\n      });\n    },\n    methods: {\n      getdata() {//获取轨迹数据\n        this.$http.get(`${this.HOST}/get/historyLocation`, {\n          params: {\n            userToken: this.userInfo.userToken,\n            imei: this.userInfo.uid,\n            start_time: this.start_time,\n            end_time: this.end_time\n          }\n        }).then(res => {\n          if (res.data.code == '000000') {\n            if (res.data.data.length != 0) {\n              this.trackData = res.data.data;\n              this.track();\n            } else {\n              this.toast('该时间阶段轨迹数据暂无')\n            }\n          } else {\n            this.toast(res.data.msg);\n          }\n        }).catch(err => {\n          this.toast('查询失败！')\n        })\n      },\n      openPicker(type) {//打开时间选择器事件\n        this.$refs.picker.open();\n        this.openpickType = type;\n      },\n      handleConfirm(val) {//\t点击确认按钮时的回调函数\n        let timestamp = Date.parse(new Date(val)) / 1000;\n        if (this.openpickType == 'start') {\n          this.start_time = timestamp\n        } else {\n          this.end_time = timestamp;\n        }\n      },\n      queryTrack() { //确定查询事件\n        if (this.start_time == '') {\n          this.toast('请选择开始时间')\n        } else if (this.end_time == '') {\n          this.toast('请选择结束时间');\n        } else {\n          this.getdata();\n        }\n      },\n      track() {\n        let _this = this;\n        this.isquery = true;\n        this.map = new AMap.Map(\"container\", {\n          resizeEnable: true,\n          zoom: 18,\n          center: this.trackData[0],\n        });\n        marker = new AMap.Marker({\n          map: this.map,\n          position: this.trackData[0],\n          icon: \"https://webapi.amap.com/theme/v1.3/markers/n/loc.png\",\n          offset: new AMap.Pixel(-20, -10),\n          autoRotation: true\n        });\n        //轨迹回放事件\n        lazyAMapApiLoaderInstance.load().then(() => {\n            this.trackData.forEach((val, index, array) => {\n              var marker_jz = new AMap.Marker({\n                map: this.map,\n                content: `<div class=\"crile\" style=\"width: 5px;height: 5px;background-color: #1296db;border-radius: 50%\"></div>`,\n                position: new AMap.LngLat(val[0], val[1]),\n                offset: new AMap.Pixel(-3, -3) //相对于基点的位置\n              });\n              marker_jz.setMap(this.map); //在地图上添加点\n            });\n            var polyline = new AMap.Polyline({\n              map: this.map,\n              path: this.trackData,\n              strokeColor: \"#f7b538\",  //线颜色\n              // strokeOpacity: 1,     //线透明度\n              strokeWeight: 3,      //线宽\n              // strokeStyle: \"solid\"  //线样式\n            });\n\n            var passedPolyline = new AMap.Polyline({\n              map: this.map,\n              // path: lineArr,\n              strokeColor: \"#1296db\",  //线颜色\n              // strokeOpacity: 1,     //线透明度\n              strokeWeight: 3,      //线宽\n              // strokeStyle: \"solid\"  //线样式\n            });\n            marker.on('moving', function (e) {\n              passedPolyline.setPath(e.passedPath);\n            });\n            this.map.setFitView();\n            marker.moveAlong(this.trackData, 100);\n          }\n        );\n      },\n      goback(){\n        this.$router.go(-1)\n      }\n    }\n  }\n  ;\n</script>\n<style lang=\"scss\" scoped>\n  @import \"../../assets/sass/_mixins.scss\";\n  @import \"../../assets/sass/_parameters.scss\";\n\n  .warper {\n    height: 100%;\n  }\n\n  #container {\n    height: 100%;\n    margin: 0px;\n    position: relative;\n  }\n\n  .cnt {\n    width: 100%;\n    text-align: center;\n    line-height: 100px;\n  }\n\n  .footer-time {\n    position: fixed;\n    bottom: 0;\n    z-index: 190;\n    @include wh(100%, 60px);\n    display: flex;\n    justify-content: space-between;\n    padding: 10px 12px;\n    box-sizing: border-box;\n    background: #f0e7a4;\n    align-items: center;\n    .time {\n      flex: 1;\n      display: flex;\n      justify-content: space-between;\n    }\n    .btn-ok {\n      margin-left: 10px;\n      flex: 0 0 50px;\n      text-align: center;\n      line-height: 35px;\n    }\n  }\n  .crile{\n    @include wh(50px,50px);\n    border-radius: 50%;\n    background-color: #1296db;\n  }\n</style>\n\n\n\n\n\n// WEBPACK FOOTER //\n// src/views/track/track.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"warper\"},[_c('mt-header',{attrs:{\"title\":\"轨迹回放\"}},[_c('mt-button',{attrs:{\"slot\":\"left\",\"icon\":\"back\"},on:{\"click\":_vm.goback},slot:\"left\"},[_vm._v(\"返回\")])],1),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isquery),expression:\"isquery\"}],attrs:{\"id\":\"container\"}}),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isquery),expression:\"!isquery\"}],staticClass:\"cnt\"},[_vm._v(\"请选择需要查询的时间段查询轨迹\")]),_vm._v(\" \"),_c('div',{staticClass:\"footer-time\"},[_c('div',{staticClass:\"time\"},[_c('p',{on:{\"click\":function($event){_vm.openPicker('start')}}},[_vm._v(_vm._s(_vm.start_time==''?'请选择开始时间':_vm.getLocalTime(_vm.start_time)))]),_vm._v(\" \"),_c('p',[_vm._v(\" - \")]),_vm._v(\" \"),_c('p',{on:{\"click\":function($event){_vm.openPicker('end')}}},[_vm._v(_vm._s(_vm.end_time==''?'请选择结束时间':_vm.getLocalTime(_vm.end_time)))])]),_vm._v(\" \"),_c('div',{staticClass:\"btn-ok\",on:{\"click\":_vm.queryTrack}},[_vm._v(\"确定\")])]),_vm._v(\" \"),_c('mt-datetime-picker',{ref:\"picker\",attrs:{\"type\":\"datetime\"},on:{\"confirm\":_vm.handleConfirm},model:{value:(_vm.pickerValue),callback:function ($$v) {_vm.pickerValue=$$v},expression:\"pickerValue\"}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.1@vue-loader/lib/template-compiler?{\"id\":\"data-v-8428c486\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.1@vue-loader/lib/selector.js?type=template&index=0!./src/views/track/track.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-8428c486\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/selector?type=styles&index=0!./track.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/selector?type=script&index=0!./track.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/selector?type=script&index=0!./track.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-8428c486\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/selector?type=template&index=0!./track.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-8428c486\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/track/track.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}